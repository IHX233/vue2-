{"version":3,"file":"vue.js","sources":["../../src/util.js","../../src/observe/array.js","../../src/observe/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["export function proxy(vm,data,key){\n    Object.defineProperty(vm,key,{\n        get(){\n            return vm[data][key]\n        },\n        set(newValue){\n            vm[data][key] = newValue\n        }\n    }) \n}\nexport function defineProperty(target,key,value){\n    Object.defineProperty(target,key,{\n        enumerable:false, //不能被枚举\n        configurable:false,\n        value\n    })\n}","let oldArrayProtoMethods = Array.prototype\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\nlet methods = ['push','pop','shift','shift','reverse','sort','splice']\nmethods.forEach(method => {\n    arrayMethods[method] = function(...arg){\n        const result = oldArrayProtoMethods[method].apply(this,arg)\n        let inserted;\n        let ob = this._ob_\n        switch(method){\n            case 'push':\n            case 'unshift'://两个都是增加，内容 可能是对象，需要劫持\n                inserted = arg\n                break;\n            case 'splice'://$set原理\n                inserted = arg.slice(2)\n            default:\n                break;\n        }\n        if(inserted){\n            ob.observeArray(inserted)\n        }\n        return result\n    }\n})","import { defineProperty } from \"../util\"\nimport { arrayMethods } from \"./array\"\n\nclass Observe{\n    constructor(value){\n        //判断一个属性是否是被观测过，看它有没有_ob_属性\n        defineProperty(value,'_ob_',this)\n        if(Array.isArray(value)){\n            value.__proto__ = arrayMethods\n            this.observeArray(value)\n        }else{\n            this.walk(value)\n        }\n        \n    }\n    observeArray(value){\n        value.forEach(item=>{\n            observe(item)\n        })\n    }\n    walk(data){\n        let keys = Object.keys(data)\n        keys.forEach(key=>{\n            defineReactive(data,key,data[key])\n        })\n    }\n}\nfunction defineReactive(data,key,value){\n    observe(value);//如果值为对象，继续监控\n    Object.defineProperty(data,key,{\n        get(){\n            console.log('get',data,key)\n            return value\n        },\n        set(newValue){\n            console.log(\"set\",data,key,newValue)\n            if(value === newValue) return\n            observe(newValue) //如果新值设置为对象，继续监控\n            value = newValue\n        }\n    })\n}\nexport function observe(data){\n    if(typeof data !== \"object\" || data == null){\n        return data\n    }\n    if(data._ob_){\n        return data\n    }\n    return new Observe(data)\n}","import { observe } from \"./observe/index.js\"\nimport {proxy} from \"./util.js\"\n\nexport function initState(vm){\n    const opt = vm.$options\n    if(opt.props){\n        initProps(vm)\n    }\n    if(opt.data){\n        initData(vm)\n    }\n    if(opt.methods){\n        initMethods(vm)\n    }\n    if(opt.computed){\n        initComputed(vm)\n    }\n    if(opt.watch){\n        initWatch(vm)\n    }\n}\nfunction initProps(){\n    \n}\n\nfunction initData(vm){\n    let data = vm.$options.data\n    vm._data = data = typeof data == 'function'?data.call(vm):data\n    for(let key in data){\n        proxy(vm,'_data',key)\n    }\n    observe(data)\n}\nfunction initMethods(){\n\n}\nfunction initComputed(){\n\n}\nfunction initWatch(){\n\n}","import {initState} from './state'\nexport function initMixin(Vue){\n    Vue.prototype._init = function(options){\n        const vm = this\n        vm.$options = options\n        //初始化状态（将数据做一个初始化劫持，当改变数据时更新视图）\n        initState(vm)\n    }\n}","import { initMixin } from \"./init\";\nexport default function Vue(options){\n    this._init(options)\n}\ninitMixin(Vue)"],"names":["proxy","vm","data","key","Object","defineProperty","get","set","newValue","target","value","enumerable","configurable","oldArrayProtoMethods","Array","prototype","arrayMethods","create","methods","forEach","method","_len","arguments","length","arg","_key","result","apply","inserted","ob","_ob_","slice","observeArray","Observe","_classCallCheck","isArray","__proto__","walk","_createClass","item","observe","keys","defineReactive","console","log","_typeof","initState","opt","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init","options"],"mappings":"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"}